<html lang="en">
<head>
<title>October 2009</title>
 <meta name="keywords" content="CowTalk" />
 <meta name="description" content="CowTalk - Moo-able Type for Cowtowncoder.com" />

 
<style type="text/css">
@import url('../stylesheets/iconic-style.css');

/************** REMOVE THIS TO UNHIDE THE BLOGGER NAVBAR ****************
**/       #b-navbar {height:0px;visibility:hidden;display:none}       /**
*************************************************************************

body {margin-top: 32px !important} 
*/

/* Let's not hide list markers... */
UL { list-style-type: disc; margin: 6; }
/* Also, better display for code: */
pre { overflow: auto; }

</style>
<script type="text/javascript" src="http://googlelite.free.fr/player.js"></script>
<script type="text/javascript">
window.google_analytics_uacct = "UA-140287-10";
</script>
</head>
<body class="layout-two-column-right">
	<div id="container">
		<div id="container-inner" class="pkg">
<!-- banner -->
<div id="banner">
	<div id="banner-inner" class="pkg">
		<h1 id="banner-header"><a href="http://www.cowtowncoder.com/blog/blog.html" accesskey="1">CowTalk</a></h1>
		<h2 id="banner-description">Moo-able Type for Cowtowncoder.com</h2>
	</div>
</div>
			<div id="pagebody">
				<div id="pagebody-inner" class="pkg">
					<div id="alpha">
						<div id="alpha-inner" class="pkg">
<!-- entry -->
   
	<h2 class="date-header">Friday, October 30, 2009 </h2>

<div class="entry" id="post-337">
			<h3 class="entry-header">Good news is news too: thoughts on and by 3 quality nonline magazines</h3>
	
	<div class="entry-content">
		<div class="entry-body">
		
			<p><p>
      If I have said it once, I hope I have said it a thousands times. This is 
      a fact: americans are pampered by the big, affordable selection of 
      quality magazines. Or at least they should be spoiled if they do read 
      them -- I am still not yet convinced they do, after living in the states 
      for a decade. This abundance of goodness is in contrast to selection of 
      daily newspapers; which are -- relatively speaking -- not that much to 
      write home about. It's almost immoral how much good stuff you can 
      actually read from refined-tree-based non-daily print products, for a 
      very modest fee. My specific selection of such Great Magazines contains 
      three exemplars -- Scientific American, <a href="http://money.cnn.com/magazines/fortune/">Fortune</a> 
      and <a href="http://ngm.nationalgeographic.com/">National Geographic</a> 
      -- but I suspect I could easily form many more such triplets and still 
      make similar statements. My choice of three is not limited my economics 
      or supply problems, but by time constraints: I can barely keep up with 
      these three, as things are.
    </p>
    <p>
      But I digress. After being inspired by one of many outstanding articles 
      (it'll be the last one I mention in this entry, so more on that one 
      later on), I thought it be fair to review one interesting and relevant 
      article from all three. So here's Tatu's October 2009 American Magazine 
      Article review.
    </p>
    <p>
      <b>1. How American Auto-Industry was Put In Its Proper Place</b>
    </p>
    <p>
      (aka &quot;The Auto Bailout: How We Did It&quot; by Fortune)
    </p>
    <p>
      Of articles chosen, this is the most close-to-earth one. It's a 
      condensed story of how GM/Chrysler cleanup project was done by the &quot;Team 
      Auto&quot; of the US government. It's easy reading, and outlines how well 
      difficult tasks can sometimes be managed, with combination of good 
      people, right timing and perhaps bit of luck. If you had asked me to 
      predict how well process could possibly succeed -- I mean, all the facts 
      were there, and odds did not look very good -- I think I would have 
      thought it unlikely that end result could be as good as it seems to be. 
      And this not so much based on the story, which mostly explains what was 
      done and how, but based on my thinking of how these things tend to go 
      (with the level of business acumen that a software engineer can possibly 
      possess, whether that's above or below average banker's talent).
    </p>
    <p>
      I really like Fortune for articles like this: it's not a dumbed down 
      version (there are weeklies that can dumb it down a notch; and then 
      newspaper that take it to almost imbecil level; and finally TV shows 
      that do the retard-a-versions for actual illiterates), but manages to be 
      very easy reading.
    </p>
    <p>
      But that's not all: Fortune also manages to be a good magazine due to 
      its contrarian spirit. For a business magazine it has very independent 
      spirit, and viewpoints presented are varied and if possible even 
      something I'd call fair. It also tackles relevant and non-easy issues -- 
      it's not just yet another WSJ (which itself actually may be one of few 
      examples of good newspapers; nonetheless, it's much more predictable and 
      thus less interesting with respect to non-daily news; but I guess that's 
      only fair for a DAILY newspaper).
    </p>
    <p>
      Anyhow: that's a good read, enough said.
    </p>
    <p>
      <b>2. Living On a Razor's Edge (by National Geographic Magazine)</b>
    </p>
    <p>
      And just so as not to get too well grounded with day-to-day (or 
      year-to-year) living, it's good to mentally teleport into another time 
      and/or place. National Geographic offers multiple articles for doing 
      that; learning about other countries, cultures, flora and fauna, and all 
      combinations thereof. Picking something to showcase is not easy: 
      multiple articles could qualify.
    </p>
    <p>
      But all things being equal, reading about Madagascar is always a safe 
      bet for learning something new and unusual. But even within those 
      expectations, the story and especially pictures that illustrate it stand 
      far apart. I mean, how would one even imagine natural constructs like 
      these cathedral-spire lookalikes? And things that live and grow on, 
      around and under them. Whoa. Besides, it's somewhat of an uplifting 
      article too, for once human development is unlikely to directly threaten 
      the thing (indirectly climate change can of course affect it, perhaps 
      destory, but that's still better than gone-in-next-five-years odds many 
      other exotic places are given)
    </p>
    <p>
      <b>3. The Rise of Vertical Farms (by Scientific American)</b>
    </p>
    <p>
      (see <a href="http://www.verticalfarm.com">http://www.verticalfarm.com</a> 
      for more)
    </p>
    <p>
      And finally this is the article that got me inspired to write about 
      stuff others write about. Article itself is sort of mind-blowing: the 
      idea of having skyscrapers used for growing our food sounds decidedly 
      futuristic, somewhat like the old (and for a while now, obsoleted) 
      future predictions of how everyone by 2000 flies around by a jet pack 
      and eats food pills for energy. But when you read the article and think 
      about it, the first questions should be &quot;would it really work?&quot;, &quot;why 
      didn't <b>*I*</b> think about it?&quot; and &quot;isn't that obvious now that I 
      read it?&quot;
    </p>
    <p>
      I like the creativity aspect of the idea; as well as its immense 
      fashionability. One of more surprising current undercurrents of 
      progressive (and I don't mean politically leftist label here) 
      forward-looking thinking is that agriculture is actually not a thing of 
      the past, declining &quot;industry&quot;, but something that is both very 
      essential for humankind and also something that is part of the future 
      and current, as well as past. The only thing that has been declining 
      wrt. farming has been amount of population it employs; but its 
      importance hasn't really reduced over time, nor will it significantly be 
      reduced any time soon. So although there has been steady pace of R&amp;D 
      over the years, it is only becoming obvious now that farming is a big 
      thing; there are lots of things wrong with it, but with all the 
      challenges there are also gigantic opportunities. This along with more 
      mundane trends of organic-food-is-cool, bundled with 
      finally-at-last-here american environmentalist awakening is really 
      making farming Cool with a capital C.
    </p>
    <p>
      And this is where this idea becomes sizzling hot: hey, not only can you 
      produce fresh food locally (where are the consumers? in cities dummy!), 
      it can be both economically beneficial, good for your health (no, not in 
      the &quot;good vibes&quot; sense of organic food but with regards to actual 
      reduction of use of pesticides, less time for spoiling etc. etc. etc.), 
      AND good for environment (less land used, less water, can recycle waste 
      water and perhaps even solids; less energy for transportation). Oh yes, 
      and also good tasting due to freshness -- fresh produce year round.
    </p>
    <p>
      <b>4. Common Threads (or Exercise in Deep Thinking by an Amateur 
      Philosophist/-logist)</b>
    </p>
    <p>
      One more interesting thing about the &quot;Big Three&quot; is that they often 
      converge around similar topics, somewhat aligned thinking, same threads; 
      sometimes it might not be trivial to even know which magazine had any 
      given article if you weren't shown it. And I don't mean this in negative 
      way -- it's not that magazines are identical, or lack identity, but 
      rather that they are varied and topic selection thereby overlaps (but is 
      not lemming-like approach of daily news). Of course, some could call 
      such convergence zeitgeist; different entities talking about similar 
      things, threads that connect things that seem unrelated (like 
      environmentalist/naturalist NG vs. business-talk of Fortune vs Geeky 
      SciAm). And cynics would claim I am just missing weekly-paced 
      groupthink. Perhaps this is part of the thing -- there being thoughts 
      floating in time (as much as I hate the word, I guess I better use it... 
      memes).
    </p>
    <p>
      But I also think there's something related to sort of national way of 
      thinking (what is the word for that again? Volkgaist?). Beyond temporal 
      similarities (wars are more relevant when they are going on, obviously; 
      significance of most events is time-bound), there is this common 
      solution-oriented approach, and choosing of similarly current topics 
      (not just fashionable, as in discussing stupid crap like celebrity 
      gossip or politician's marital prolems) is something these magazines 
      share. And most importantly: there is always this underlying faith in 
      things improving over time. I suspect this is something profoundly 
      american; something more genuine than stomach-revoltingly-plastic 
      flag-waving variety of americana.
    </p>
    <p>
      What I mean is that many articles talk about how things could be 
      improved; it is actually quite rare to read an article where the overall 
      tone is negative, much less something where things are pointed out to be 
      hopeless. One could of course claim that's just good business sense (who 
      would pay to read about bad stuff), but that's easily rebuked: selling 
      social porn and doom-and-gloom is the business of TV networks, and quite 
      a profitable plan at that.
    </p>
    <p>
      Anyway, enough soap-box philosophizing (is that a word? can make it one 
      if not?). Thank you for time. And please consider subscribing to some of 
      these great affordable american magazines, if you don't already. I'd 
      rather they be around during my lifetime, and maybe even my children. 
      There'll be more time to read when I retire. :-)
    </p></p>

	<p class="entry-footer">
		<span class="post-footers">Posted by Tatu Saloranta  at Friday, October 30, 2009 11:47 PM </span>
<br />	Categories: <a href="http://www.cowtowncoder.com/blog/archives/cat_environment.html">Environment</a>, <a href="http://www.cowtowncoder.com/blog/archives/cat_fooddrink.html">Food+Drink</a>, <a href="http://www.cowtowncoder.com/blog/archives/cat_philosophic.html">Philosophic</a>
<br />
<span class="separator">|</span> <a class="permalink" href="http://www.cowtowncoder.com/blog/archives/2009/10/entry_337.html">Permalink</a>
<span class="separator">|</span><a href="http://www.cowtowncoder.com/blog/archives/2009/10/entry_337.html#disqus_thread">Comments</a>
<BlogItemBacklinksEnabled> | <a href="http://www.cowtowncoder.com/blog/archives/2009/10/entry_337.html#links">links to this post</a></BlogItleaemBacklinksEnabled> 

	</p>
		</div>
	</div>
</div>
   
	<h2 class="date-header">Thursday, October 29, 2009 </h2>

<div class="entry" id="post-295">
			<h3 class="entry-header">On State of State Machines</h3>
	
	<div class="entry-content">
		<div class="entry-body">
		
			<p><p resolver="NamedStyle:default {name=default,font-weight=normal,font-family=Tahoma,font-size=3,FONT_ATTRIBUTE_KEY=javax.swing.plaf.FontUIResource[family=Dialog,name=Tahoma,style=plain,size=11],font-style=,}" margin-top="0">
      <a href="http://en.wikipedia.org/wiki/State_machine">State Machines</a> 
      are things that all programmers should recall from their basic Computer 
      Science courses, along with other basics like binary trees and merge 
      sort. But until fairly recently I thought that they are mostly useful as 
      low-level constructs, built by generator code like compiler compilers 
      and regular expression packages. This contempt was fueled by having seen 
      multiple cases of gratuitous usage: for example, state machines were 
      used to complicate simple task of parsing paragraphs of line-oriented 
      configuration files when I worked at Sun. So my thinking was that state 
      machines are only fit for compilers to produce, something non-kosher for 
      enlightened developers.
    </p>
    <p resolver="NamedStyle:default {name=default,font-weight=normal,font-family=Tahoma,font-size=3,FONT_ATTRIBUTE_KEY=javax.swing.plaf.FontUIResource[family=Dialog,name=Tahoma,style=plain,size=11],font-style=,}" margin-top="0">
      But about two years ago I started realizing that state machines are 
      actually nifty little devices, not only to be created by software but 
      also by wetware. And that their main benefit can actually be simplicity 
      of the resulting solution -- when used in right places.
    </p>
    <p resolver="NamedStyle:default {name=default,font-weight=normal,font-family=Tahoma,font-size=3,FONT_ATTRIBUTE_KEY=javax.swing.plaf.FontUIResource[family=Dialog,name=Tahoma,style=plain,size=11],font-style=,}" margin-top="0">
      <b>1. Block Me Not</b>
    </p>
    <p resolver="NamedStyle:default {name=default,font-weight=normal,font-family=Tahoma,font-size=3,FONT_ATTRIBUTE_KEY=javax.swing.plaf.FontUIResource[family=Dialog,name=Tahoma,style=plain,size=11],font-style=,}" margin-top="0">
      The first place where I realized usefulness of state machines was within 
      bowels of an XML parser. Specifically, when trying to write a 
      non-blocking (asynchronous) parsing core of <a href="http://wiki.fasterxml.com/AaltoHome">Aalto</a> 
      XML processor (more on this nice piece of software engineering in 
      future, I promise)
    </p>
    <p resolver="NamedStyle:default {name=default,font-weight=normal,font-family=Tahoma,font-size=3,FONT_ATTRIBUTE_KEY=javax.swing.plaf.FontUIResource[family=Dialog,name=Tahoma,style=plain,size=11],font-style=,}" margin-top="0">
      Challenge with writing a non-blocking parser is simple: whereas blocking 
      parser -- one that explicitly reads input from a stream and can block 
      until input is available -- has full control of control flow, including 
      ability to only stop when it wants to (at a token boundary; after fully 
      parsing an element, or comment), a non-blocking parser is at mercy of 
      whoever feeds it with data. If there is no more data for non-blocking 
      parser to read, it has to store whatever state it has and return control 
      to caller, ready or not. Which basically means it may have to stop 
      parsing at any given character; or even better, within half-way THROUGH 
      a character, which can happen with multi-byte UTF-8 characters And do it 
      in such way that whenever more data does become available, it is ready 
      to resume parsing based on newly available data.
    </p>
    <p resolver="NamedStyle:default {name=default,font-weight=normal,font-family=Tahoma,font-size=3,FONT_ATTRIBUTE_KEY=javax.swing.plaf.FontUIResource[family=Dialog,name=Tahoma,style=plain,size=11],font-style=,}" margin-top="0">
      So what is needed to do that? Ability to fully store and restore the 
      state. And this is where state machine made its entrance: gee, wouldn't 
      it make sense to explicitly separate out state, and create a state 
      machine to handle execution. Or, in this case, set of small state 
      machines.
    </p>
    <p resolver="NamedStyle:default {name=default,font-weight=normal,font-family=Tahoma,font-size=3,FONT_ATTRIBUTE_KEY=javax.swing.plaf.FontUIResource[family=Dialog,name=Tahoma,style=plain,size=11],font-style=,}" margin-top="0">
      Indeed it does; and once you go that route implementation is not nearly 
      as complicated as it would be if one tried to do it all using regular 
      procedural code (which might just be infeasibe altogether)
    </p>
    <p resolver="NamedStyle:default {name=default,font-weight=normal,font-family=Tahoma,font-size=3,FONT_ATTRIBUTE_KEY=javax.swing.plaf.FontUIResource[family=Dialog,name=Tahoma,style=plain,size=11],font-style=,}" margin-top="0">
      <b>2. All Your Base64 Are Belong To Us</b>
    </p>
    <p resolver="NamedStyle:default {name=default,font-weight=normal,font-family=Tahoma,font-size=3,FONT_ATTRIBUTE_KEY=javax.swing.plaf.FontUIResource[family=Dialog,name=Tahoma,style=plain,size=11],font-style=,}" margin-top="0">
      Ok, complex state keeping should be an obvious place for state machines 
      to rule. But much smaller tasks can benefit as well.<br>Base64 decoding 
      is a good example: given that decoding needs to be flexible with respect 
      to things like white space (linefeeds at arbitrary locations), possible 
      limitations on amount that can be decoded with one pass (with 
      incremental parsing, as is the case with <a href="http://wiki.fasterxml.com/WoodstoxHome">Woodstox</a>), 
      and the need to handle possible padding at the end, writing a method 
      that does base64 decoding is a non-trivial task. I tried doing that, and 
      resulting code was anything but elegant. I would even go as far as call 
      it fugly.
    </p>
    <p resolver="NamedStyle:default {name=default,font-weight=normal,font-family=Tahoma,font-size=3,FONT_ATTRIBUTE_KEY=javax.swing.plaf.FontUIResource[family=Dialog,name=Tahoma,style=plain,size=11],font-style=,}" margin-top="0">
      That is, until I realized I should apply earlier lessons and see what 
      comes of simple state keeping and looping. Lo and behold, tight loop of 
      base64 decoding is tight both by amount of code (rather small) and 
      processing time (pretty damn fast). Resulting state machine has just 8 
      states (4 characters per 24-bit unit to decode, few more to handle 
      padding), and code is surprisingly simple and easy to follow (but still 
      long enough not to be included here -- check out Woodstox/Stax2 API 
      class &quot;org.codehaus.stax2.ri.typed.CharArrayBase64Decoder&quot; if you are 
      interested in details).
    </p>
    <p resolver="NamedStyle:default {name=default,font-weight=normal,font-family=Tahoma,font-size=3,FONT_ATTRIBUTE_KEY=javax.swing.plaf.FontUIResource[family=Dialog,name=Tahoma,style=plain,size=11],font-style=,}" margin-top="0">
      <b>3. Case of &quot;I really should have...&quot;</b>
    </p>
    <p resolver="NamedStyle:default {name=default,font-weight=normal,font-family=Tahoma,font-size=3,FONT_ATTRIBUTE_KEY=javax.swing.plaf.FontUIResource[family=Dialog,name=Tahoma,style=plain,size=11],font-style=,}" margin-top="0">
      One more case where state machine approach would probably have worked 
      well is that of &quot;decoding framed XML stream&quot;.<br>
    </p>
    <p resolver="NamedStyle:default {name=default,font-weight=normal,font-family=Tahoma,font-size=3,FONT_ATTRIBUTE_KEY=javax.swing.plaf.FontUIResource[family=Dialog,name=Tahoma,style=plain,size=11],font-style=,}" margin-top="0">
      At work, there is an analysis system that has to read gigabytes of data. 
      Data consists of a sequence of short XML documents, separated by marker 
      byte sequences that act as simple framing mechanism. Task itself is 
      simple: take a stream, split it into segments (by markers), feed to 
      parser. But to make it both reliable and efficient is not quite as easy: 
      marker sequence consists of multiple bytes, and theoretically bytes in 
      question could belong to a document: it's the full sequence that can not 
      be contained within document. Plus for extra credit one should try to 
      avoid having to re-read data multiple times.
    </p>
    <p resolver="NamedStyle:default {name=default,font-weight=normal,font-family=Tahoma,font-size=3,FONT_ATTRIBUTE_KEY=javax.swing.plaf.FontUIResource[family=Dialog,name=Tahoma,style=plain,size=11],font-style=,}" margin-top="0">
      So, foolishly I went ahead and managed to write piece of code that does 
      such de-framing (demultiplexing) efficiently (which is needed for scale 
      of processing we do). But code looks butt ugly; and took a bit of 
      testing to make work correctly. Unfortunately I only had the light bulb 
      moment after writing (... and fixing) the code: Would this not be a 
      PERFECT case for writing a little state machine, where one state is used 
      for each byte of the marker sequence?
    </p>
    <p resolver="NamedStyle:default {name=default,font-weight=normal,font-family=Tahoma,font-size=3,FONT_ATTRIBUTE_KEY=javax.swing.plaf.FontUIResource[family=Dialog,name=Tahoma,style=plain,size=11],font-style=,}" margin-top="0">
      Maybe next time I actually consider techniques I recently re-discovered, 
      and apply them appropriately. :-)
    </p></p>

	<p class="entry-footer">
		<span class="post-footers">Posted by Tatu Saloranta  at Thursday, October 29, 2009 7:02 PM </span>
<br />	Categories: <a href="http://www.cowtowncoder.com/blog/archives/cat_java.html">Java</a>, <a href="http://www.cowtowncoder.com/blog/archives/cat_opensource.html">Open Source</a>
<br />
<span class="separator">|</span> <a class="permalink" href="http://www.cowtowncoder.com/blog/archives/2009/10/entry_295.html">Permalink</a>
<span class="separator">|</span><a href="http://www.cowtowncoder.com/blog/archives/2009/10/entry_295.html#disqus_thread">Comments</a>
<BlogItemBacklinksEnabled> | <a href="http://www.cowtowncoder.com/blog/archives/2009/10/entry_295.html#links">links to this post</a></BlogItleaemBacklinksEnabled> 

	</p>
		</div>
	</div>
</div>
   
	<h2 class="date-header">Wednesday, October 28, 2009 </h2>

<div class="entry" id="post-257">
			<h3 class="entry-header">Data Format anti-patterns: converting between secondary artifacts (like xml to json)</h3>
	
	<div class="entry-content">
		<div class="entry-body">
		
			<p><p resolver="NamedStyle:default {name=default,font-weight=normal,font-style=,font-family=Tahoma,font-size=3,FONT_ATTRIBUTE_KEY=javax.swing.plaf.FontUIResource[family=Dialog,name=Tahoma,style=plain,size=11],}" margin-top="0">
      One commonly asked but fundamentally flawed question is &quot;how do I 
      convert xml to json&quot; (or vice versa).<br>Given frequency at which I 
      have encountered it, it probably ranks high on list of data format <a href="http://en.wikipedia.org/wiki/Anti_pattern">anti-patterns</a>.
    </p>
    <p resolver="NamedStyle:default {name=default,font-weight=normal,font-style=,font-family=Tahoma,font-size=3,FONT_ATTRIBUTE_KEY=javax.swing.plaf.FontUIResource[family=Dialog,name=Tahoma,style=plain,size=11],}" margin-top="0">
      And just to be clear: I don't mean that there is any problem in having 
      (or wanting to have) systems that produce data using multiple 
      alternative data formats (views, representations). Quite on contrary: 
      ability to do so is at core of REST(-like) web services, which are one 
      useful form of web services. Rather, I think it is wrong to <b>convert</b> 
      between such representations.
    </p>
    <p resolver="NamedStyle:default {name=default,font-weight=normal,font-style=,font-family=Tahoma,font-size=3,FONT_ATTRIBUTE_KEY=javax.swing.plaf.FontUIResource[family=Dialog,name=Tahoma,style=plain,size=11],}" margin-top="0">
      <b>1. Why is it Anti-pattern?</b>
    </p>
    <p resolver="NamedStyle:default {name=default,font-weight=normal,font-style=,font-family=Tahoma,font-size=3,FONT_ATTRIBUTE_KEY=javax.swing.plaf.FontUIResource[family=Dialog,name=Tahoma,style=plain,size=11],}" margin-top="0">
      Simply put: you should never convert from secondary (non-authoritative) 
      representation into another such representation. Rather, you should 
      render your source data (which is usually in relational model, or 
      objects) into such secondary formats. So: if you need xml, map your 
      objects to xml (using <a href="http://jaxb.dev.java.net">JAXB</a> or <a href="http://xstream.codehaus.org">XStream</a> 
      or what you have); if you need JSON, map it using <a href="http://jackson.codehaus.org">Jackson</a>. 
      And ditto for the reverse direction.
    </p>
    <p resolver="NamedStyle:default {name=default,font-weight=normal,font-style=,font-family=Tahoma,font-size=3,FONT_ATTRIBUTE_KEY=javax.swing.plaf.FontUIResource[family=Dialog,name=Tahoma,style=plain,size=11],}" margin-top="0">
      This of course implies that there are cases where such transformation 
      might make sense: namely, when your data storage format is XML (Native 
      Xml DBs) or Json (CouchDB). In those cases you just have to worry about 
      the practical problem of model/format impedance, similar to what happens 
      when doing Object-Relational Mapping (ORM).
    </p>
    <p resolver="NamedStyle:default {name=default,font-weight=normal,font-style=,font-family=Tahoma,font-size=3,FONT_ATTRIBUTE_KEY=javax.swing.plaf.FontUIResource[family=Dialog,name=Tahoma,style=plain,size=11],}" margin-top="0">
      <b>2. Ok: simple case is simple, but how about multiple mappings?</b>
    </p>
    <p resolver="NamedStyle:default {name=default,font-weight=normal,font-style=,font-family=Tahoma,font-size=3,FONT_ATTRIBUTE_KEY=javax.swing.plaf.FontUIResource[family=Dialog,name=Tahoma,style=plain,size=11],}" margin-top="0">
      Sometimes you do need multi-step processing; for example, if your data 
      lives in the database. Following my earlier suggestion, it would seem 
      like you should convert directly from relational model (storage format) 
      into resulting transfer format (json or xml). Ideally, yes: if there are 
      such conversions. But in practice it is more likely that a two-phase 
      mapping (ORM from database to objects; and then from objects to xml or 
      json) works better: mostly because there are good tools for separate 
      phases, but fewer that would do the end-to-end rendition.
    </p>
    <p resolver="NamedStyle:default {name=default,font-weight=normal,font-style=,font-family=Tahoma,font-size=3,FONT_ATTRIBUTE_KEY=javax.swing.plaf.FontUIResource[family=Dialog,name=Tahoma,style=plain,size=11],}" margin-top="0">
      Is this wrong? No. To understand why, it is necessary to understand 3 
      classes of formats that are talking about:
    </p>
    <ul>
      <li resolver="NamedStyle:default {name=default,font-weight=normal,font-style=,font-family=Tahoma,font-size=3,FONT_ATTRIBUTE_KEY=javax.swing.plaf.FontUIResource[family=Dialog,name=Tahoma,style=plain,size=11],}" margin-top="0">
        Persistence (storage) format, used for storing your data: usually 
        relational model but can be something else as well (objects for object 
        DBs; XML for native XML databases)
      </li>
      <li>
        Processing format: Objects or structs of your processing language 
        (POJOs for Java) that you use for actual processing. Occasionally this 
        can also be something more exotic; like XML when using XSLT (or 
        relational data for complicated reporting queries)
      </li>
      <li>
        Transfer format: Serialization format used to transfer data between 
        end points (or sometimes time-shifting, saving state over restart); 
        may be closely bound to processing format (as is the case for Java 
        serialization)
      </li>
    </ul>
    <p>
      So what I am really saying is that you should not transfer within a 
      class of formats; in this case between 2 alternate transfer formats. It 
      is acceptable (and often sensible) to do conversions between classes of 
      formats; and sometimes doing 2 transforms is simpler than trying to one 
      bigger one. Just not within a class.
    </p>
    <p>
      <b>3. Three Formats may be simpler than Just One</b>
    </p>
    <p>
      One more thing about above-mentioned three formats: there is also a 
      related fallacy of thinking that there is a problem if you are using 
      multiple formats/models (like relational model for storage, objects for 
      processing and xml or json for transfer). Assumption is that additional 
      transformations needed to convert between representations is wasteful 
      enough to be a problem in and of itself. But it should be rather obvious 
      why there are often distinct models and formats in use: <b>because each 
      is optimal for specific use case</b>. Storage format is good for, gee, 
      storing data; processing model good for efficiently massaging data, and 
      transfer format good for piping it through the wire. As long as you 
      don't add gratuitous conversions in-between, transforming on boundary is 
      completely sensible; especially considering alternative of trying to 
      find a single model that works for all cases. One only needs to consider 
      case of &quot;XML for everything&quot; cluster (esp. XML for processing, aka XSLT) 
      to see why this is an approach that should be avoided (or, Java 
      serialization as transfer format -- that is another anti-pattern in and 
      of itself).
    </p></p>

	<p class="entry-footer">
		<span class="post-footers">Posted by Tatu Saloranta  at Wednesday, October 28, 2009 10:22 PM </span>
<br />	Categories: <a href="http://www.cowtowncoder.com/blog/archives/cat_json.html">JSON</a>, <a href="http://www.cowtowncoder.com/blog/archives/cat_xmlstax.html">XML/Stax</a>
<br />
<span class="separator">|</span> <a class="permalink" href="http://www.cowtowncoder.com/blog/archives/2009/10/entry_257.html">Permalink</a>
<span class="separator">|</span><a href="http://www.cowtowncoder.com/blog/archives/2009/10/entry_257.html#disqus_thread">Comments</a>
<BlogItemBacklinksEnabled> | <a href="http://www.cowtowncoder.com/blog/archives/2009/10/entry_257.html#links">links to this post</a></BlogItleaemBacklinksEnabled> 

	</p>
		</div>
	</div>
</div>
   
	<h2 class="date-header">Friday, October 16, 2009 </h2>

<div class="entry" id="post-335">
			<h3 class="entry-header">Eclipse, meet Subversion, vice versa, and PLEASE play nice together</h3>
	
	<div class="entry-content">
		<div class="entry-body">
		
			<p><p>
      Oh well. I thought it was too much to ask to expect Eclipse to play nice 
      with Subversion -- that pesky annoying habit of blindly copying 
      subversion metadata files, leading to irritating &quot;The resource is a 
      duplicate of .svn/...&quot; errors, one for each directory you have within 
      Subversion project.
    </p>
    <p>
      But <a href="http://blog.projectnibble.org/2009/08/11/repost-make-eclipse-ignore-svn-directories/">this 
      little blog posting</a> saved my day. Finally. After all the useless 
      other workarounds (*), including installing Subversion-compatibility 
      plug-ins (which could be useful per se, just not able to suppress this 
      svn annoyance).
    </p>
    <p>
      (* - yes, there are other ways to actually get rid of this warning, but 
      usually less elegant; also, there are a few suggestions that do not even 
      resolve it);
    </p>
    <p>
      
    </p></p>

	<p class="entry-footer">
		<span class="post-footers">Posted by Tatu Saloranta  at Friday, October 16, 2009 9:11 PM </span>
<br />	Categories: <a href="http://www.cowtowncoder.com/blog/archives/cat_java.html">Java</a>
<br />
<span class="separator">|</span> <a class="permalink" href="http://www.cowtowncoder.com/blog/archives/2009/10/entry_335.html">Permalink</a>
<span class="separator">|</span><a href="http://www.cowtowncoder.com/blog/archives/2009/10/entry_335.html#disqus_thread">Comments</a>
<BlogItemBacklinksEnabled> | <a href="http://www.cowtowncoder.com/blog/archives/2009/10/entry_335.html#links">links to this post</a></BlogItleaemBacklinksEnabled> 

	</p>
		</div>
	</div>
</div>
   
	<h2 class="date-header">Sunday, October 11, 2009 </h2>

<div class="entry" id="post-332">
			<h3 class="entry-header">Fresh new hope for JSON Schema: "Orderly" improvements afoot!</h3>
	
	<div class="entry-content">
		<div class="entry-body">
		
			<p><p>
      Here's something interesting related to on-going (if slowly moving) <a href="http://www.json-schema.org/">JSON 
      Schema</a> effort: <a href="http://trickyco.de/2009/10/02/orderly-jsonschema">Orderly</a> 
      micro-language. Orderly just might be that something that makes JSON 
      Schema usable. There are other things that could do that, too, like good 
      tool support; but more convenient syntax seems like the shortest route 
      to improved usability: a custom-built DSL that does NOT (have to) use 
      the target syntax as its own syntax. What a great idea! (not a novel 
      one; RelaxNG compact syntax has been around for a while, and that wasn't 
      new -- no matter, good ideas are good ideas)
    </p>
    <p>
      As the web site says: &quot;Orderly... is an ergonomic micro-language that 
      can round-trip to JSONSchema ... ... optional. syntactic sugar, fluff. 
      Tools should speak JSONSchema, but for areas where humans have to read 
      or write the schema there should be an option to expose orderly in 
      addition to JSON&quot;. Sounds good, I like that.
    </p>
    <p>
      We shall see if and how this works out. My personal interest is more in 
      the area of type definition language -- for me validation is actually 
      not all that interesting; mostly because I believe it can be done quite 
      well at (Java) object level (see <a href="http://jcp.org/en/jsr/detail?id=303">Bean 
      Validation API</a>). So much so that even XML Schema is used much more 
      as type definition language for data binding (as THE Object/XML type 
      system for things like Soap, JAXB) than for actual XML validation, 
      although original focus has squarely on handling validation aspects. 
      Futher indirect proof is that its main competitor, RelaxNG, which is 
      superior alternative for validation, isn't nearly as popular overall -- 
      it would totally squash Schema if validation was the dominant use case 
      for XML schema languages; but RelaxNG is not very useful for data 
      binding, alas (because it allows ambiguity in grammar, acceptable for 
      validation, but problematic when trying to do type inference and 
      matching).
    </p>
    <p>
      But I digress. I think that a prettified DSL that translates to/from 
      JSON Schema could handle type system aspects just as well JSON Schema 
      would; which is to say, &quot;possibly well enough to be useful&quot;. Although 
      JSON Schema as is has some nasty flaws in this area (only single type 
      per schema? you kidding me, right? All references via static URLs? 
      Really?), maybe it can all work out in the end with some spit and 
      polish. Jury is still out.
    </p></p>

	<p class="entry-footer">
		<span class="post-footers">Posted by Tatu Saloranta  at Sunday, October 11, 2009 6:12 PM </span>
<br />	Categories: <a href="http://www.cowtowncoder.com/blog/archives/cat_java.html">Java</a>, <a href="http://www.cowtowncoder.com/blog/archives/cat_json.html">JSON</a>
<br />
<span class="separator">|</span> <a class="permalink" href="http://www.cowtowncoder.com/blog/archives/2009/10/entry_332.html">Permalink</a>
<span class="separator">|</span><a href="http://www.cowtowncoder.com/blog/archives/2009/10/entry_332.html#disqus_thread">Comments</a>
<BlogItemBacklinksEnabled> | <a href="http://www.cowtowncoder.com/blog/archives/2009/10/entry_332.html#links">links to this post</a></BlogItleaemBacklinksEnabled> 

	</p>
		</div>
	</div>
</div>
   
	<h2 class="date-header">Saturday, October 10, 2009 </h2>

<div class="entry" id="post-334">
			<h3 class="entry-header">My 100 days back at the Mother of All E-Business</h3>
	
	<div class="entry-content">
		<div class="entry-body">
		
			<p><p resolver="NamedStyle:default {font-weight=normal,font-family=Tahoma,font-style=,FONT_ATTRIBUTE_KEY=javax.swing.plaf.FontUIResource[family=Dialog,name=Tahoma,style=plain,size=11],name=default,font-size=3,}" margin-top="0">
      Time sure flies when you are having fun! Why: just today I realized it's 
      approximately 100 days since I (re)started at Amazon!<br>This 
      realization was based on having had to reset my password last week; and 
      cycle between mandatory password change is 3 months.
    </p>
    <p resolver="NamedStyle:default {font-weight=normal,font-family=Tahoma,font-style=,FONT_ATTRIBUTE_KEY=javax.swing.plaf.FontUIResource[family=Dialog,name=Tahoma,style=plain,size=11],name=default,font-size=3,}" margin-top="0">
      I guess 3 months is still within loose definition of the Honeymoon, i.e. 
      initial period of positive view on one's (still) new employer, team and 
      surroundings. Nonetheless I am positively surprised how positive I feel 
      about about things I work on and people I work with. It obviously helps 
      that the company is doing well (as well as could be expected given 
      macro-economic situation); but that doesn't quite compare to joy for 
      high caliber of people that make things run, and that I have pleasure to 
      work with. Especially so for my team: this is only the second time in my 
      whole career (of 14 years) when I feel I am surrounded by people who 
      know more about whole many things than I do; including core technical 
      skills (for curious, the first time was in mid-to-late 90s, back in 
      Helsinki). And the beauty of this all is that we are also working on 
      somewhat cutting edge systems; not merely with regards to scale of 
      operational things ( I generally don't care how many servers you waste 
      CPU time on, or how many gigabytes of disk space they have -- that's 
      sort of cool when you are starting your career, but you quickly [should] 
      get over it), but rather with regards to complexity of the problem 
      domain and resulting (mostly) essential complexity of solutions to solve 
      problems. We are solving not only very big but also very hard problems. 
      And that takes time; slowly, piece by piece new things get built, big 
      beast of complexity starved to death. Fortunately Amazon has (and groks) 
      something that is not very common in enterprise world: patience and 
      long-term view; focus on things that matter, and perseverence to see 
      through what you need and decide to do. Now that the team has worked on 
      longer term plan for multiple years, results are accumulating, and 
      that's the most exciting thing overall.
    </p>
    <p resolver="NamedStyle:default {font-weight=normal,font-family=Tahoma,font-style=,FONT_ATTRIBUTE_KEY=javax.swing.plaf.FontUIResource[family=Dialog,name=Tahoma,style=plain,size=11],name=default,font-size=3,}" margin-top="0">
      Anyway: I am very content with what I am doing now (hi there Sachin! can 
      I get my raise now?). Enough said about that. No one likes people who 
      brag about their marital bliss, luck in lottery, or amount of money, 
      fame and chicks open source activities bring about. :-)
    </p>
    <p resolver="NamedStyle:default {font-weight=normal,font-family=Tahoma,font-style=,FONT_ATTRIBUTE_KEY=javax.swing.plaf.FontUIResource[family=Dialog,name=Tahoma,style=plain,size=11],name=default,font-size=3,}" margin-top="0">
      But one final thought on subject of work life, compared to my open 
      source night time hacking: situation has always been such that the two 
      are very loosely (if at all) connected. At first this seemed 
      unfortunate, but over time I have come to appreciate this distinction: 
      if the two were interlinked, wouldn't it just mean I spent both my work 
      day and chunk of free time for work? And would it not also be putting 
      all eggs in single basket? So perhaps there is something here similar to 
      the rule of &quot;never start a business with a friend (or relative)&quot; (if 
      business goes sour, you will be neither business partner nor friends; 
      and even without that, there's enough tension to rip apart friendship): 
      it may be good to keep open source &quot;hobby&quot; arms-length separate from 
      paid-for development work. Much like work life is often best kept 
      distinct from family life -- not totally apart of course; friends from 
      work will be friends outside work too; and sometimes one world 
      temporarily plunges into the other -- but at least asynchronous, 
      transiently co-habiting temporal spectrum, but mostly not (ha! I never 
      thought I'd write such a long sentence outside of tech specs...)
    </p>
    <p resolver="NamedStyle:default {font-weight=normal,font-family=Tahoma,font-style=,FONT_ATTRIBUTE_KEY=javax.swing.plaf.FontUIResource[family=Dialog,name=Tahoma,style=plain,size=11],name=default,font-size=3,}" margin-top="0">
      ps. If there's anyone with solid programming skills, background in NLP 
      (or closely related areas), wish to solve actual real-life important 
      problems and need or desire to get a (new) job, shoot me an email. We 
      are still hiring. Stuff will be sold over the Internet, and facts need 
      to extracted to support this lucractive business!
    </p></p>

	<p class="entry-footer">
		<span class="post-footers">Posted by Tatu Saloranta  at Saturday, October 10, 2009 12:40 AM </span>
<br />	Categories: <a href="http://www.cowtowncoder.com/blog/archives/cat_philosophic.html">Philosophic</a>
<br />
<span class="separator">|</span> <a class="permalink" href="http://www.cowtowncoder.com/blog/archives/2009/10/entry_334.html">Permalink</a>
<span class="separator">|</span><a href="http://www.cowtowncoder.com/blog/archives/2009/10/entry_334.html#disqus_thread">Comments</a>
<BlogItemBacklinksEnabled> | <a href="http://www.cowtowncoder.com/blog/archives/2009/10/entry_334.html#links">links to this post</a></BlogItleaemBacklinksEnabled> 

	</p>
		</div>
	</div>
</div>
   
	<h2 class="date-header">Thursday, October 08, 2009 </h2>

<div class="entry" id="post-330">
			<h3 class="entry-header">Handling Base64-encoded binary data with Jackson</h3>
	
	<div class="entry-content">
		<div class="entry-body">
		
			<p><p>
      Hopefully by now you know that <a href="http://wiki.fasterxml.com/WoodstoxHome">Woodstox</a> 
      can <a href="http://www.cowtowncoder.com/blog/archives/2009/09/entry_320.html">handle 
      base64-encoded binary data</a> for your XML use cases. You may even know 
      that <a href="http://wiki.fasterxml.com/JacksonHome ">Jackson</a> can do 
      the same for JSON (notice that &quot;g.writeBinary()&quot; call in <a href="http://wiki.fasterxml.com/JacksonInFiveMinutes">Jackson 
      Tutorial</a>?)
    </p>
    <p>
      But there is actually bit more to know about base64 functionality here. 
      Let's first review core Base64 handling with 3 main processing models 
      Jackson supports.
    </p>
    <p>
      <b>1. Handling base64-encoded binary with Streaming API </b>
    </p>
    <p>
      Assuming you get JSON content like:
    </p>
    <pre>{
  &quot;binary&quot; : &quot;hc3VyZS4=&quot;
}</pre>
    <p>
      you can get binary data out by, say:
    </p>
    <pre>  JsonParser jp = new JsonFactory().createJsonParser(jsonStr);
  jp.nextToken(); // START_OBJECT
  jp.nextValue(); // VALUE_STRING that has base64 (skips field name as that's not a value)
  byte[] data = jp.getBinaryValue();</pre>
    <p>
      And if you want to produce similar data, you can do:
    </p>
    <pre>  byte[] data = ...;
  StringWriter sw = new StringWriter();
  JsonGenerator jg = new JsonFactory().createJsonGenerator(sw);
  jg.writeStartObject();
  jg.writeFieldName(&quot;binary&quot;); // 1.3 will have &quot;writeBinaryField()&quot; method
  jg.writeBinary(data, 0, data.length);
  jg.writeEndObject();</pre>
    <p>
      <b>2. Handling base64-encoded binary with Data Binding</b>
    </p>
    <p>
      But where JsonParser and JsonGenerator make access quite easy, 
      ObjectMapper makes it ridiculously easy. You just use 'byte[]' as the 
      data type, and ObjectMapper binds data as expected.
    </p>
    <pre>  static class Bean {
    public byte[] binary;
  }

  ObjectMapper mapper = new ObjectMapper();
  Bean bean = mapper.readValue(jsonStr, Bean.class); 
  byte[] data = bean.binary; // Want to serialize it? Sure:
  String outputStr = mapper.writeValueAsString(bean); // note: Jackson 1.3 only; otherwise use StringWriter</pre>
    <p>
      <b>3. Handling base64-encoded binary with Tree Model</b>
    </p>
    <p>
      Handling binary data is almost as easy with Tree Model as well:
    </p>
    <pre>  JsonNode object = mapper.readTree(jsonStr);
  JsonNode binaryNode = object.get(&quot;binary&quot;);
  byte[] data = binaryNode.getBinaryValue();

  // or construct from scratch, write?
  ObjectNode rootOb = mapper.createObjectNode();
  rootOb.put(&quot;binary&quot;, rootOb.binaryNode(data));
  outputStr = mapper.writeValueAsString(rootOb);</pre>
    <p>
      <b>4. Additional Tricks</b>
    </p>
    <p>
      <i>(DISCLAIMER</i>: following features have been tested with Jackson 
      1.3, not yet released)
    </p>
    <p>
      But what if you actually just want to encode or decode binary data 
      to/from Base64-encoded Strings, outside context of JSON processing?
    </p>
    <p>
      Turns out that you can do simple encoding and decoding quite easily. And 
      as an additional bonus, Jackson's strong focus on performance means that 
      the underlying codec is very efficient, even for &quot;extra-curricular&quot; use 
      (where output buffering is not utilized as it is for incremental JSON 
      processing).<br>In fact, it may just be faster than alternative commonly 
      used processing toolkits.
    </p>
    <p>
      Anyway: to encode arbitrary binary data as, you can do:
    </p>
    <pre>  import org.codehaus.jackson.node.BinaryNode;

  BinaryNode n = new BinaryNode(byteArray);
  String encodedText = n.getValueAsText();<br><br>  // or as one-liner: encodedText = new BinaryNode(data).getValueAsText();</pre>
    <p>
      and to decode given Base64-encoded String, you can retrieve contained 
      binary data by:
    </p>
    <pre>  import org.codehaus.jackson.node.TextNode;

  TextNode n = new TextNode(encodedString);
  byte[] data = n.getBinaryValue();<br><br>  // or as one-liner: data = new TextNode().getBinaryValue();<br>  // or, if encoded using non-standard Base64 variant, try:
  data = n.getBinaryValue(Base64Variants.MODIFIED_FOR_URL);</pre>
    <p>
      Useful? Possibly -- no need to include Jakarta Commons Codec just for 
      Base64 handling, if you happen to use Jackson already.
    </p></p>

	<p class="entry-footer">
		<span class="post-footers">Posted by Tatu Saloranta  at Thursday, October 08, 2009 10:59 PM </span>
<br />	Categories: <a href="http://www.cowtowncoder.com/blog/archives/cat_json.html">JSON</a>
<br />
<span class="separator">|</span> <a class="permalink" href="http://www.cowtowncoder.com/blog/archives/2009/10/entry_330.html">Permalink</a>
<span class="separator">|</span><a href="http://www.cowtowncoder.com/blog/archives/2009/10/entry_330.html#disqus_thread">Comments</a>
<BlogItemBacklinksEnabled> | <a href="http://www.cowtowncoder.com/blog/archives/2009/10/entry_330.html#links">links to this post</a></BlogItleaemBacklinksEnabled> 

	</p>
		</div>
	</div>
</div>
   
	<h2 class="date-header">Wednesday, October 07, 2009 </h2>

<div class="entry" id="post-329">
			<h3 class="entry-header">Test First? Only if tests are the first and foremost deliverable...</h3>
	
	<div class="entry-content">
		<div class="entry-body">
		
			<p><p>
      Ok, given that my view on testing, unit tests, and &quot;things of that 
      nature&quot; has slowly but surely evolved over time, I like reading what 
      others have to say on subject. The only readings I steer clear of are 
      fanboy articles, and possibly &quot;it sucks because I'm contrarian&quot; 
      counterpoints. This still leaves lots of good material. For example, &quot;<a href="http://gigamonkeys.com/blog/2009/10/05/coders-unit-testing.html">Unit 
      testing in Coders at Work</a>&quot; is a delightul compilation of multiple 
      good (and some so-so) view points.
    </p>
    <p>
      My personal favorite is the last episode: case of &quot;a TDD proponent and 
      another good programmer&quot;. Although it is but a single case I do think it 
      suggests something simple yet fundamental: you tend to achieve whatever 
      is your  main goal. And if you consider Testing with capital T to be the 
      most impotant thing; well, you will get good tests. But what does NOT 
      follow is that you get stellar design or even code. You just get a 
      design and an implementation that works the way you expected it to work. 
      Which is not a bad thing per se; just not necessarily intrinsically 
      good. That is: good design and implementation untested is better than 
      perfectly tested but badly designed or implemented thing; it is easier 
      to find implementation problems (bugs) than to re-design or re-implement.
    </p>
    <p>
      That is probably my biggest misgiving regarding &quot;Test First&quot; idea: it 
      does suggest that testing comes before anything else -- not just 
      temporally, which may or may not make sense (often does; as often does 
      not), but most importantly, as priority. For me testing is a very 
      important supporting area: very useful (as I have said, none of my open 
      source projects would have nearly as good quality and maintainability as 
      they have without lots of time spent on writing and maintaining test 
      code!), but ultimately not a goal but a tool to achieve the goals.
    </p>
    <p>
      With respect to article, another pleasant observation is that I tend to 
      agree with most practicioners interviewed. Pragmatism seems to be a core 
      trait of good programmers: if not a defining one, at least one strongly 
      correlated with core competencies. I suspect that has lots to do with 
      the failure of the &quot;TDD guy&quot; on his try with Sudoku solving, as well as 
      misplaced (if understandable, considering he was writing material for 
      his blog) focus on testing.
    </p></p>

	<p class="entry-footer">
		<span class="post-footers">Posted by Tatu Saloranta  at Wednesday, October 07, 2009 8:48 PM </span>
<br />	Categories: <a href="http://www.cowtowncoder.com/blog/archives/cat_general.html">General</a>, <a href="http://www.cowtowncoder.com/blog/archives/cat_philosophic.html">Philosophic</a>
<br />
<span class="separator">|</span> <a class="permalink" href="http://www.cowtowncoder.com/blog/archives/2009/10/entry_329.html">Permalink</a>
<span class="separator">|</span><a href="http://www.cowtowncoder.com/blog/archives/2009/10/entry_329.html#disqus_thread">Comments</a>
<BlogItemBacklinksEnabled> | <a href="http://www.cowtowncoder.com/blog/archives/2009/10/entry_329.html#links">links to this post</a></BlogItleaemBacklinksEnabled> 

	</p>
		</div>
	</div>
</div>
   
	<h2 class="date-header">Saturday, October 03, 2009 </h2>

<div class="entry" id="post-328">
			<h3 class="entry-header">Joys of unit testing: finding a 5 year old bug (dormant, harmless, but a bug nonetheless)</h3>
	
	<div class="entry-content">
		<div class="entry-body">
		
			<p><p>
      Well here is something I don't do every day: write a unit test mostly to 
      improve code coverage metrics, and find a dormant, almost 5-year old 
      bug. But that's exactly what I did today: the bug was found in <a href="http://wiki.fasterxml.com/JacksonHome">Jackson</a> 
      i/o package. And, it turns out, in 2 other libraries (Woodstox, Aalto) 
      as well: code has been evolved over time, being originally written for <a href="http://wiki.fasterxml.com/WoodstoxHome">Woodstox</a> 
      (checked in almost 5 years ago), and finding its way into <a href="http://wiki.fasterxml.com/AaltoHome">Aalto</a> 
      and Jackson later on.
    </p>
    <p>
      So what was the bug? It was a bug in 'InputStream.skip()' method, which 
      skipped different number of bytes than it reported; return value was 
      number that was requested, not number that was actually skipped. Simple 
      case of mistaken variables.
    </p>
    <p>
      And why was this bug not found earlier? Because this code path was never 
      really executed -- just because skip() method exists in InputStream 
      doesn't mean it is used. Except when someone writes a unit test to 
      exercise it.
    </p>
    <p>
      In the end I guess there are 2 complementary ways to think about this: 
      first, try to unit test all code you have; and second, do not write code 
      you do not plan to use. That is, given that I wasn't expecting to ever 
      use this method, perhaps I should have written it to throw an 
      IOException right away. And if was ever needed, then (and only then!) 
      write it and add unit tests.
    </p></p>

	<p class="entry-footer">
		<span class="post-footers">Posted by Tatu Saloranta  at Saturday, October 03, 2009 11:12 PM </span>
<br />	Categories: <a href="http://www.cowtowncoder.com/blog/archives/cat_java.html">Java</a>
<br />
<span class="separator">|</span> <a class="permalink" href="http://www.cowtowncoder.com/blog/archives/2009/10/entry_328.html">Permalink</a>
<span class="separator">|</span><a href="http://www.cowtowncoder.com/blog/archives/2009/10/entry_328.html#disqus_thread">Comments</a>
<BlogItemBacklinksEnabled> | <a href="http://www.cowtowncoder.com/blog/archives/2009/10/entry_328.html#links">links to this post</a></BlogItleaemBacklinksEnabled> 

	</p>
		</div>
	</div>
</div>
   
	<h2 class="date-header">Thursday, October 01, 2009 </h2>

<div class="entry" id="post-327">
			<h3 class="entry-header">Critical updates: Woodstox 4.0.6 released</h3>
	
	<div class="entry-content">
		<div class="entry-body">
		
			<p><p>
      This just in: <a href="http://wiki.fasterxml.com/WoodstoxDownload">Woodstox 
      4.0.6</a> was released, and it contains just one fix; but that one to a 
      critical problem (text content truncation for long CDATA sections, when 
      using <b>XMLStreamReader.getElementText()</b>). Upgrade is highly 
      recommended for anyone using earlier 4.0 releases.
    </p>
    <p>
      One more potentially useful addition is that I uploaded &quot;relocation&quot; 
      Maven pom, for non-existing artifact &quot;wstx-asl&quot; v4.0.6 (the real id is 
      &quot;woostox-core-asl&quot;, as of 4.0; &quot;wstx-asl&quot; was used with 3.2 and 
      previous). This was suggested by a user, to make upgrade bit less 
      painful -- problem is that Woodstox tends to be one of those ubiquitous 
      transitive dependencies to anyone running a Soap service (or nowadays 
      almost any server-side XML processing system).
    </p>
    <p>
      Next big thing should then be Jackson-1.3, stay tuned!
    </p></p>

	<p class="entry-footer">
		<span class="post-footers">Posted by Tatu Saloranta  at Thursday, October 01, 2009 9:23 PM </span>
<br />	Categories: <a href="http://www.cowtowncoder.com/blog/archives/cat_java.html">Java</a>, <a href="http://www.cowtowncoder.com/blog/archives/cat_xmlstax.html">XML/Stax</a>
<br />
<span class="separator">|</span> <a class="permalink" href="http://www.cowtowncoder.com/blog/archives/2009/10/entry_327.html">Permalink</a>
<span class="separator">|</span><a href="http://www.cowtowncoder.com/blog/archives/2009/10/entry_327.html#disqus_thread">Comments</a>
<BlogItemBacklinksEnabled> | <a href="http://www.cowtowncoder.com/blog/archives/2009/10/entry_327.html#links">links to this post</a></BlogItleaemBacklinksEnabled> 

	</p>
		</div>
	</div>
</div>
   
            </div>
        </div>
        <div id="beta">
         	<div id="beta-inner" class="pkg">
<!-- sidebar -->


<!-- Search -->
<div class="module-search module">
<h2 class="module-header">Search</h2>
<hr />

<!-- SiteSearch Google -->

<style type="text/css">
@import url(http://www.google.com/cse/api/branding.css);
</style>
<div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
  <div class="cse-branding-form">
    <form action="http://www.google.com/cse" id="cse-search-box">
      <div>
        <input type="hidden" name="cx" value="partner-pub-1467773697956887:yd8k3mcue4v" />
        <input type="hidden" name="ie" value="UTF-8" />
        <input type="text" name="q" size="24" />
        <input type="submit" name="sa" value="Search" />
      </div>
    </form>
  </div>
  <div class="cse-branding-logo">
    <img src="http://www.google.com/images/poweredby_transparent/poweredby_FFFFFF.gif" alt="Google" />
  </div>
  <div class="cse-branding-text">
    Custom Search
  </div>
</div>
<!-- /SiteSearch Google -->
</div>
<hr />
<div class="module-archives module">
  <h2 class="module-header">Last posts</h2>
  <div class="module-content">
    <ul class="module-list">
<li class="module-list-item"><a href="http://www.cowtowncoder.com/blog/archives/2009/10/entry_337.html">Good news is news too: thoughts on and by 3 quality nonline magazines</a></li>
<li class="module-list-item"><a href="http://www.cowtowncoder.com/blog/archives/2009/10/entry_295.html">On State of State Machines</a></li>
<li class="module-list-item"><a href="http://www.cowtowncoder.com/blog/archives/2009/10/entry_257.html">Data Format anti-patterns: converting between secondary artifacts (like xml to json)</a></li>
<li class="module-list-item"><a href="http://www.cowtowncoder.com/blog/archives/2009/10/entry_335.html">Eclipse, meet Subversion, vice versa, and PLEASE play nice together</a></li>
<li class="module-list-item"><a href="http://www.cowtowncoder.com/blog/archives/2009/10/entry_332.html">Fresh new hope for JSON Schema: "Orderly" improvements afoot!</a></li>

    </ul>
  </div>
</div>

<!-- Google AdSense, medium one (200x200) -->
<script type="text/javascript">
google_ad_client = "pub-1467773697956887";
/* cowtown-blog-200x200-1 */
google_ad_slot = "3247601086";
google_ad_width = 200;
google_ad_height = 200;
</script>
<script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<!-- /Google AdSense -->
     
<div class="module-categories module">
  <h2 class="module-header">Categories</h2>
		<div class="module-content">
        <ul>
		
			<a href="http://www.cowtowncoder.com/blog/archives/cat_database.html">Database</a><br />
		
			<a href="http://www.cowtowncoder.com/blog/archives/cat_environment.html">Environment</a><br />
		
			<a href="http://www.cowtowncoder.com/blog/archives/cat_fooddrink.html">Food+Drink</a><br />
		
			<a href="http://www.cowtowncoder.com/blog/archives/cat_general.html">General</a><br />
		
			<a href="http://www.cowtowncoder.com/blog/archives/cat_java.html">Java</a><br />
		
			<a href="http://www.cowtowncoder.com/blog/archives/cat_json.html">JSON</a><br />
		
			<a href="http://www.cowtowncoder.com/blog/archives/cat_music.html">Music</a><br />
		
			<a href="http://www.cowtowncoder.com/blog/archives/cat_opensource.html">Open Source</a><br />
		
			<a href="http://www.cowtowncoder.com/blog/archives/cat_performance.html">Performance</a><br />
		
			<a href="http://www.cowtowncoder.com/blog/archives/cat_philosophic.html">Philosophic</a><br />
		
			<a href="http://www.cowtowncoder.com/blog/archives/cat_rant.html">Rant</a><br />
		
			<a href="http://www.cowtowncoder.com/blog/archives/cat_silly.html">Silly</a><br />
		
			<a href="http://www.cowtowncoder.com/blog/archives/cat_staxmate.html">StaxMate</a><br />
		
			<a href="http://www.cowtowncoder.com/blog/archives/cat_xmlstax.html">XML/Stax</a><br />
		
        </ul>
		</div>
	</div>
<div class="module-syndicate module">
	<div class="module-content">
		<a href="http://www.cowtowncoder.com/blog/rss.xml">Subscribe to this blog's feed</a><br />

		[<a href="http://help.blogger.com/bin/answer.py?answer=697">What is this?</a>]
	</div>

</div>

<div class="module-archives module">
          <h2 class="module-header">Archives</h2>
          <div class="module-content">
               <ul class="module-list">
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/08-01-2012_08-31-2012.html'>August 2012</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/05-01-2012_05-31-2012.html'>May 2012</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/04-01-2012_04-30-2012.html'>April 2012</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/03-01-2012_03-31-2012.html'>March 2012</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/12-01-2011_12-31-2011.html'>December 2011</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/10-01-2011_10-31-2011.html'>October 2011</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/09-01-2011_09-30-2011.html'>September 2011</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/08-01-2011_08-31-2011.html'>August 2011</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/07-01-2011_07-31-2011.html'>July 2011</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/05-01-2011_05-31-2011.html'>May 2011</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/04-01-2011_04-30-2011.html'>April 2011</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/03-01-2011_03-31-2011.html'>March 2011</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/02-01-2011_02-28-2011.html'>February 2011</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/01-01-2011_01-31-2011.html'>January 2011</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/12-01-2010_12-31-2010.html'>December 2010</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/11-01-2010_11-30-2010.html'>November 2010</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/10-01-2010_10-31-2010.html'>October 2010</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/09-01-2010_09-30-2010.html'>September 2010</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/08-01-2010_08-31-2010.html'>August 2010</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/07-01-2010_07-31-2010.html'>July 2010</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/06-01-2010_06-30-2010.html'>June 2010</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/05-01-2010_05-31-2010.html'>May 2010</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/04-01-2010_04-30-2010.html'>April 2010</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/03-01-2010_03-31-2010.html'>March 2010</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/02-01-2010_02-28-2010.html'>February 2010</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/01-01-2010_01-31-2010.html'>January 2010</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/12-01-2009_12-31-2009.html'>December 2009</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/11-01-2009_11-30-2009.html'>November 2009</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/10-01-2009_10-31-2009.html'>October 2009</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/09-01-2009_09-30-2009.html'>September 2009</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/08-01-2009_08-31-2009.html'>August 2009</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/07-01-2009_07-31-2009.html'>July 2009</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/06-01-2009_06-30-2009.html'>June 2009</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/05-01-2009_05-31-2009.html'>May 2009</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/04-01-2009_04-30-2009.html'>April 2009</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/03-01-2009_03-31-2009.html'>March 2009</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/02-01-2009_02-28-2009.html'>February 2009</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/01-01-2009_01-31-2009.html'>January 2009</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/12-01-2008_12-31-2008.html'>December 2008</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/11-01-2008_11-30-2008.html'>November 2008</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/10-01-2008_10-31-2008.html'>October 2008</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/09-01-2008_09-30-2008.html'>September 2008</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/08-01-2008_08-31-2008.html'>August 2008</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/07-01-2008_07-31-2008.html'>July 2008</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/06-01-2008_06-30-2008.html'>June 2008</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/05-01-2008_05-31-2008.html'>May 2008</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/04-01-2008_04-30-2008.html'>April 2008</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/03-01-2008_03-31-2008.html'>March 2008</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/02-01-2008_02-29-2008.html'>February 2008</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/12-01-2007_12-31-2007.html'>December 2007</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/11-01-2007_11-30-2007.html'>November 2007</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/10-01-2007_10-31-2007.html'>October 2007</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/09-01-2007_09-30-2007.html'>September 2007</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/08-01-2007_08-31-2007.html'>August 2007</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/07-01-2007_07-31-2007.html'>July 2007</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/06-01-2007_06-30-2007.html'>June 2007</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/05-01-2007_05-31-2007.html'>May 2007</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/04-01-2007_04-30-2007.html'>April 2007</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/02-01-2007_02-28-2007.html'>February 2007</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/01-01-2007_01-31-2007.html'>January 2007</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/11-01-2006_11-30-2006.html'>November 2006</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/10-01-2006_10-31-2006.html'>October 2006</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/09-01-2006_09-30-2006.html'>September 2006</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/08-01-2006_08-31-2006.html'>August 2006</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/07-01-2006_07-31-2006.html'>July 2006</a></li>
              
                <li class="module-list-item"><a href='http://www.cowtowncoder.com/blog/archives/06-01-2006_06-30-2006.html'>June 2006</a></li>
              
               </ul>
          </div>
</div>

<!-- Google AdSense, smallish one (120x240) -->
<script type="text/javascript">
google_ad_client = "pub-1467773697956887";
/* cowtown-blog-120x240-1 */
google_ad_slot = "0198703199";
google_ad_width = 120;
google_ad_height = 240;
</script>
<script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<!-- /Google AdSense -->
<hr />

<h2 class="module-header">Related Blogs</h2>
<div class="module-content">
(by Author (topics))
               <ul class="module-list">
<li class="module-list-item"><a href="http://netzooid.com/blog/">Dan D</a>
<br />(XFire, Mule)
</li>
<li class="module-list-item"><a href="http://jfarcand.wordpress.com/">Jean-Francois A</a><br /> (Ajax, Comet, Async HTTP)
</li>
<li class="module-list-item"><a href="http://jazzjuice.blogspot.com/">Josh C</a><br />(Judge Mental)
</li>
<li class="module-list-item"><a href="http://weblogs.java.net/blog/kohsuke/">Kohsuke K</a><br />(Relax NG, Sun MSV)
</li>
<li class="module-list-item"><a href="http://saxonica.blogharbor.com/">Michael K</a><br />(xslt, xquery)
</li>
<li class="module-list-item"><a href="http://mult.ifario.us/a">Paul B</a><br />(Haskell, RSS)
</li>
<li class="module-list-item"><a href="http://weblogs.java.net/blog/spericas/">Santiago P-G</a><br />(Glassfish, java.net, JAXP, Xalan)
</li>
               </ul>
          </div>
</div>
<div class="module-powered module">
	<h2 class="module-header">Powered By</h2>

	<div class="module-content"><!-- powered by -->
<a href="http://thingamablog.sourceforge.net/"><img
 alt="Powered by Thingamablog" src="http://thingamablog.sourceforge.net/images/powered.gif"></a>,
 <br /><a href="http://blogger-templates.blogspot.com">Blogger Templates</a>.
  </div>
</div>

<!-- Author desc -->
<div class="module-photo module">
     <div class="module-content"><img src="/picture_library/cowtowncoder.jpg"></div>
</div>
<div class="module-about module">
     <h2 class="module-header">About me</h2>
     <div class="module-content">
       <ul class="module-list">
         <li class="module-list-item">I am known as <strong>Cowtowncoder</strong></li>
         <li class="module-list-item">Contact me at<a href="mailto:cowtowncoder">@yahoo.com</a></li>
       </ul>
Check my <a href="/author-cowtowncoder.html">profile</a> to learn more.
     </div>
</div>

<!-- Discus comments -->
<script type="text/javascript">
//<![CDATA[
(function() {
	var links = document.getElementsByTagName('a');
	var query = '?';
	for(var i = 0; i < links.length; i++) {
	if(links[i].href.indexOf('#disqus_thread') >= 0) {
		query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&';
	}
	}
	document.write('<script charset="utf-8" type="text/javascript" src="http://disqus.com/forums/cowtalk/get_num_replies.js' + query + '"></' + 'script>');
})();
//]]>
</script>
<!-- GA -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-140287-10");
pageTracker._trackPageview();
} catch(err) {}</script>     
</body>
</html>
